diff --git a/extras/contrib/bootstrap b/extras/contrib/bootstrap
index 77c6733..38f50c2 100755
--- a/extras/contrib/bootstrap
+++ b/extras/contrib/bootstrap
@@ -88,6 +88,30 @@ case $HOST in
 	    EXTRA_LDFLAGS=" -isysroot \${MACOSX_SDK} -Wl,-syslibroot,\${MACOSX_SDK}"
 	    echo "PATH = /bin:/usr/bin:/usr/local/bin" >> config.mak
         ;;
+    i686-apple-darwin9)
+        SDK_TARGET=10.4
+        MIN_LD_VERSION_WITH_TEXT_RELOCATION=81
+        echo "SDK_TARGET = ${SDK_TARGET}" >> config.mak
+        echo "HAVE_DARWIN_OS = 1" >> config.mak
+        echo "HAVE_DARWIN_OS_ON_INTEL = 1" >> config.mak
+        echo "HAVE_DARWIN_9 = 1" >> config.mak
+        if test `ld -v 2> /dev/stdout | sed -E 's/.*ld64-([0-9]+).*/\1/'` -lt ${MIN_LD_VERSION_WITH_TEXT_RELOCATION}; then
+            echo "Please update your developer tools - ld is broken"
+            exit 1
+        fi
+        echo "ENVP = MACOSX_DEPLOYMENT_TARGET=${SDK_TARGET}" >> config.mak
+        echo "MACOSX_SDK = /Developer/SDKs/MacOSX10.4u.sdk" >> config.mak
+        CFLAGS_TUNING=" -march=pentium-m -mtune=prescott"
+        EXTRA_CFLAGS=" -D\${ENVP} -isysroot \${MACOSX_SDK} -mmacosx-version-min=\${SDK_TARGET}"
+        EXTRA_LDFLAGS=" -isysroot \${MACOSX_SDK} -Wl,-syslibroot,\${MACOSX_SDK}"
+        echo "PATH = /bin:/usr/bin:/usr/local/bin" >> config.mak
+        if test -e /Developer/SDKs; then
+            echo "SDKs found. Everything is fine." >&2
+        else
+            echo "ERROR:\nYour Developer Tools' SDKs were not found.\nYou need to add extra symbolic links to /Developer to achieve correctly\nbuilt contribs.\nHave a look at the OSX-Compile-HOWTO for details." >&2
+            exit 1
+        fi
+    ;;
     i586-pc-beos)
             echo "HAVE_BEOS = 1" >> config.mak
             if test -f /boot/beos/system/lib/libbind.so; then
diff --git a/modules/access_output/http.c b/modules/access_output/http.c
index ecd1ea3..9ce8371 100644
--- a/modules/access_output/http.c
+++ b/modules/access_output/http.c
@@ -180,45 +180,36 @@ static int Open( vlc_object_t *p_this )
     psz_bind_addr = psz_parser = strdup( p_access->psz_name );
 
     i_bind_port = 0;
-    psz_file_name = "";
 
-    while( *psz_parser && *psz_parser != ':' && *psz_parser != '/' )
-    {
-        psz_parser++;
-    }
-    if( *psz_parser == ':' )
+    psz_parser = strchr( psz_bind_addr, '/' );
+    if( psz_parser )
     {
+        psz_file_name = strdup( psz_parser );
         *psz_parser = '\0';
-        psz_parser++;
-        i_bind_port = atoi( psz_parser );
-
-        while( *psz_parser && *psz_parser != '/' )
-        {
-            psz_parser++;
-        }
     }
-    if( *psz_parser == '/' )
-    {
-        *psz_parser = '\0';
-        psz_parser++;
-        psz_file_name = psz_parser;
-    }
-
-    if( !*psz_file_name )
-    {
+    else
         psz_file_name = strdup( "/" );
-    }
-    else if( *psz_file_name != '/' )
-    {
-        char *p = psz_file_name;
 
-        psz_file_name = malloc( strlen( p ) + 2 );
-        strcpy( psz_file_name, "/" );
-        strcat( psz_file_name, p );
+    if( psz_bind_addr[0] == '[' )
+    {
+        psz_bind_addr++;
+        psz_parser = strstr( psz_bind_addr, "]:" );
+        if( psz_parser )
+        {
+            *psz_parser = '\0';
+            i_bind_port = atoi( psz_parser + 2 );
+        }
+        psz_parser = psz_bind_addr - 1;
     }
     else
     {
-        psz_file_name = strdup( psz_file_name );
+        psz_parser = strrchr( psz_bind_addr, ':' );
+        if( psz_parser )
+        {
+            *psz_parser = '\0';
+            i_bind_port = atoi( psz_parser + 1 );
+        }
+        psz_parser = psz_bind_addr;
     }
 
     /* SSL support */
@@ -244,14 +235,14 @@ static int Open( vlc_object_t *p_this )
                                             psz_crl );
     if( p_sys->p_httpd_host == NULL )
     {
-        msg_Err( p_access, "cannot listen on %s:%d",
+        msg_Err( p_access, "cannot listen on %s port %d",
                  psz_bind_addr, i_bind_port );
         free( psz_file_name );
-        free( psz_bind_addr );
+        free( psz_parser );
         free( p_sys );
         return VLC_EGENERIC;
     }
-    free( psz_bind_addr );
+    free( psz_parser );
 
     if( p_access->psz_access && !strcmp( p_access->psz_access, "mmsh" ) )
     {
diff --git a/modules/mux/mp4.c b/modules/mux/mp4.c
index 31e8f2e..85d6513 100644
--- a/modules/mux/mp4.c
+++ b/modules/mux/mp4.c
@@ -723,7 +723,6 @@ static void ConvertAVC1( sout_mux_t *p_mux, mp4_stream_t *tk, block_t *p_block )
             memcpy( tk->avc.sps, &last[4], i_size );
 
             tk->avc.i_profile = tk->avc.sps[1];
-            tk->avc.i_profile = tk->avc.sps[2];
             tk->avc.i_profile_compat = tk->avc.sps[2];
             tk->avc.i_level   = tk->avc.sps[3];
         }
